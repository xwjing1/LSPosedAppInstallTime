# 快速开始指南

## 为什么选择 LSPosed？

✅ **可以选择作用域** - 在 LSPosed Manager 中可以打勾选择对哪些应用生效  
✅ **实现简单** - 纯 Java 代码，比 Zygisk 简单  
✅ **易于调试** - 可以查看日志  
✅ **灵活配置** - 支持动态配置

## 完整安装流程

### 第一步：安装 LSPosed 框架

1. 打开 Magisk Manager
2. 搜索 "LSPosed"
3. 安装 LSPosed 模块
4. 重启设备
5. 安装 LSPosed Manager 应用（从 GitHub 下载）

### 第二步：编译 LSPosed 模块

#### 使用 Android Studio（推荐）

1. 下载并安装 Android Studio
2. 打开 Android Studio
3. 选择 "Open" -> 选择 `LSPosedAppInstallTime` 文件夹
4. 等待 Gradle 同步（可能需要几分钟）
5. 点击菜单 "Build" -> "Build Bundle(s) / APK(s)" -> "Build APK(s)"
6. 编译完成后，点击 "locate" 或找到文件：
   ```
   app/build/outputs/apk/debug/app-debug.apk
   ```

#### 使用命令行（需要安装 JDK 和 Android SDK）

```bash
cd LSPosedAppInstallTime
./gradlew assembleDebug
```

### 第三步：安装 Magisk 模块（提供配置）

1. 安装 `AppInstallTimeMod.zip` Magisk 模块
2. 重启设备
3. 配置文件位置：`/data/adb/modules/AppInstallTimeMod/config.json`

### 第四步：安装和配置 LSPosed 模块

1. 安装编译好的 APK（`app-debug.apk`）
2. 打开 LSPosed Manager
3. 在"模块"列表中找到 "AppInstallTimeMod"
4. **启用模块**
5. **点击模块名称**，进入作用域选择
6. **选择 "系统框架" (android)** ← 重要！
7. 重启设备

### 第五步：配置要修改的应用

编辑配置文件：`/data/adb/modules/AppInstallTimeMod/config.json`

```json
{
  "enabled": true,
  "packages": {
    "com.tencent.mm": 1577836800000,
    "com.tencent.mobileqq": 1609459200000
  }
}
```

- `com.tencent.mm` = 微信包名
- `1577836800000` = 2020-01-01 的时间戳

### 第六步：验证

```bash
# 查看日志
adb logcat | grep AppInstallTimeMod

# 查看应用安装时间
adb shell dumpsys package com.tencent.mm | grep firstInstallTime
```

## LSPosed 作用域说明

### 推荐设置：系统框架

1. 在 LSPosed Manager 中打开模块
2. 选择作用域为 **"系统框架" (android)**
3. 这样所有应用都会生效（根据配置文件中的包名）

### 可选：选择特定应用

1. 在 LSPosed Manager 中打开模块
2. 选择需要修改的应用
3. 只有选中的应用会生效

**注意**：由于我们 Hook 的是系统框架中的 PackageManagerService，建议选择"系统框架"作为作用域。

## 配置文件说明

### 位置
```
/data/adb/modules/AppInstallTimeMod/config.json
```

### 格式
```json
{
  "enabled": true,
  "packages": {
    "包名1": 时间戳1,
    "包名2": 时间戳2
  }
}
```

### 时间戳转换

**在线工具**：https://www.epochconverter.com/

**常用日期**：
- 2020-01-01 = `1577836800000`
- 2021-01-01 = `1609459200000`
- 2022-01-01 = `1640995200000`

**JavaScript**：
```javascript
new Date('2020-01-01 00:00:00 UTC').getTime()
```

## 查找应用包名

```bash
# 查看所有应用
adb shell pm list packages

# 搜索微信
adb shell pm list packages | grep -i wechat
# 或
adb shell pm list packages | grep tencent
```

## 常见问题

### Q: 模块不生效？

A: 检查以下几点：
1. LSPosed 框架已安装并启用
2. 在 LSPosed Manager 中已启用模块
3. 已选择作用域（系统框架）
4. 配置文件格式正确
5. 已重启设备
6. 查看日志：`adb logcat | grep AppInstallTimeMod`

### Q: 如何只对特定应用生效？

A: 
- 方法1：在配置文件中只配置需要的应用
- 方法2：在 LSPosed Manager 中选择作用域为特定应用

### Q: 修改配置后需要重启吗？

A: 是的，修改配置文件后需要重启设备。

### Q: 可以临时禁用吗？

A: 
- 在 LSPosed Manager 中禁用模块
- 或设置配置文件中的 `"enabled": false`

## 项目文件说明

- `MainHook.java` - Hook 实现代码
- `AndroidManifest.xml` - 模块声明
- `build.gradle` - 构建配置
- `config.json` - 配置文件（在 Magisk 模块中）

## 技术支持

如果遇到问题：
1. 查看日志：`adb logcat | grep AppInstallTimeMod`
2. 检查配置文件格式
3. 确认 LSPosed 框架正常工作
4. 确认作用域选择正确
